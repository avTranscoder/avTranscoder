import os
import platform

Import( 'AvTranscoder' )
Import( 'sAvTranscoder' )
#Import( 'AvTranscoder_jar' )
Import( 'installPrefix' )
Import( "resampleLibraryName" )

env = Environment().Clone()

Import( 'env' )

avinfo = env.Program(
        'avinfo',
        Glob( 'avInfo/*.cpp' ),
        LIBS = [
                sAvTranscoder,
                'avutil',
                'avformat',
                'avcodec',
                'swscale',
                resampleLibraryName,
                ]
        )

avmeta = env.Program(
        'avmeta',
        Glob( 'avMeta/*.cpp' ),
        LIBS = [
                sAvTranscoder,
                'avutil',
                'avformat',
                'avcodec',
                'swscale',
                resampleLibraryName,
                ]
        )

avtransform = env.Program(
        'av++',
        Glob( 'avTranscoder/*.cpp' ),
        LIBS = [
                sAvTranscoder,
                'avutil',
                'avformat',
                'avcodec',
                'swscale',
                resampleLibraryName,
                ]
        )

avprocessor = env.Program(
        'avprocessor',
        Glob( 'genericProcessor/*.cpp' ),
        LIBS = [
                sAvTranscoder,
                'avutil',
                'avformat',
                'avcodec',
                'swscale',
                resampleLibraryName,
                ],
        CXXFLAGS = [
                '-std=c++0x'
                ],
        )

audioRewrapper = env.Program(
        'audioWrap',
        Glob( 'audioRewrapper/*.cpp' ),
        LIBS = [
                sAvTranscoder,
                'avutil',
                'avformat',
                'avcodec',
                'swscale',
                resampleLibraryName,
                ]
        )

if platform.system() != 'Windows':
        avplayer = env.Program(
                'avplayer',
                Glob( 'avplay/*.cpp' ),
                LIBS = [
                        sAvTranscoder,
                        'avutil',
                        'avformat',
                        'avcodec',
                        'swscale',
                        resampleLibraryName,
                        'GL',
                        'glut',
                        ]
                )
        
        avprofiles = env.Program(
                'avprofiles',
                Glob( 'presetChecker/*.cpp' ),
                LIBS = [
                        sAvTranscoder,
                        'avutil',
                        'avformat',
                        'avcodec',
                        'swscale',
                        resampleLibraryName,
                        ],
                CXXFLAGS = [
                        '-std=c++0x'
                        ],
        )

avprofiles = env.Program(
        'avoptions',
        Glob( 'optionChecker/*.cpp' ),
        LIBS = [
                sAvTranscoder,
                'avutil',
                'avformat',
                'avcodec',
                'swscale',
                resampleLibraryName,
                ],
        CXXFLAGS = [
                '-std=c++0x'
                ],
        )

env.Depends( avmeta, sAvTranscoder )
env.Depends( audioRewrapper, sAvTranscoder )

env.Alias( "install", env.Install(os.path.join( installPrefix, "bin" ), avmeta ) )
env.Alias( "install", env.Install(os.path.join( installPrefix, "bin" ), avprocessor ) )
env.Alias( "install", env.Install(os.path.join( installPrefix, "bin" ), avtransform ) )
env.Alias( "install", env.Install(os.path.join( installPrefix, "bin" ), audioRewrapper ) )
